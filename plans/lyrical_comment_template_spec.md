[['VARIABLE_NAME]` - Basic variable\n- `[VARIABLE_NAME | default_value]` - Variable with default value\n\n## Available Template Variables\n\n### Family Data Variables\n\n| Variable | Description | Data Source | Example Value |\n|----------|-------------|-------------|---------------|\n| `CHILD_COUNT` | Number of children in the family | `families.children_count` | 4 |\n| `CHILD_AGES` | Array of child ages | `families.children_ages` | [2, 5, 8, 10] |\n| `OLDEST_CHILD_AGE` | Age of the oldest child | Derived from `children_ages` | 10 |\n| `YOUNGEST_CHILD_AGE` | Age of the youngest child | Derived from `children_ages` | 2 |\n| `CHILD_NAMES` | Array of child names | `family_members.name` where `role` = \'child\' | ["Ahmad', 'Leila', 'Yousef'], ['diabetes', 'asthma'], ['NUMBER | 14] insulin units left. My [AGE_1 | 5]-year-old [CHILD_ROLE_1 | son] did the math: 3 days per unit if [GENDER_PRONOUN | he] eats nothing. 5 days if [GENDER_PRONOUN | he] "sleeps more.', ["GENDER_PRONOUN | He] marked [CHILD_NAME_2 | sister]'s birthday on the calendar. Drew hearts.", "I'll save 2 units for that day, mama. To be awake.", ['POSSESSIVE_PRONOUN | She] doesn\'t know [POSSESSIVE_PRONOUN | her] party depends on [POSSESSIVE_PRONOUN | his] survival math.\n```\n\n### Example 2: Baby Template\n```\nThe baby is [AGE_1 | 2]. Too young to understand war. Old enough to understand gone. Points at the door waiting for [CHILD_NAME_1 | her] father. We buried him [NUMBER | 71] days ago. [CHILD_NAME_1 | She] still points. Still waits. My [AGE_2 | 10]-year-old told [CHILD_NAME_1 | her] "Baba went to get food.', "Now [CHILD_NAME_1 | she] points at empty plates too.\n```\n\n## Template Categories\n\nTemplates should be categorized by theme:\n1. **Medical Crisis** - Medical conditions, medications, treatments\n2. **Hunger/Scarcity** - Food shortages, rationing, hunger\n3. **Cold/Weather** - Cold, lack of heating, weather conditions\n4. **Displacement** - Moving, temporary housing, loss of home\n5. **Death/Loss** - Deceased family members, funeral experiences\n6. **Childhood's End** - Children taking on adult responsibilities\n7. **Innocence/Wisdom** - Children's profound observations\n8. **Daily Survival** - Routine survival challenges\n\n## Template Requirements\n\n### Voice Profile Compliance\n1. **Length**: 40-60 words maximum\n2. **Specific Number**: Must include ONE specific number\n3. **Child's Observation**: Must end with a child's observation\n4. **First Person**: Written as if from the mother's perspective\n5. **No Begging**: No direct requests for help or money\n6. **Immediacy**: Use time markers like", 'Yesterday,"', 'Last night," "This morning"\n\n### Technical Requirements\n1. **Variable Usage**: Templates should use 2-5 variables for personalization\n2. **Default Values**: All variables should have sensible defaults\n3. **Grammar**: Templates should be grammatically correct when variables are replaced\n4. **Sensitivity**: Templates should be culturally appropriate and respectful\n\n## Database Integration\n\n### Comment Templates Table Structure\n\nThe existing `comment_templates` table will be used with these fields:\n\n| Field | Description | Example |\n|-------|-------------|---------|\n| `id` | Unique identifier | 1 |\n| `template_text` | The template with variables |', ['NUMBER] insulin units left. My [AGE]-year-old..." |\n| `has_fields` | Boolean indicating if template uses variables | true |\n| `field_requirements` | JSON specifying required data | {"children_count', True, 'children_ages": true} |\n| `category` | Template category | "medical_crisis" |\n| `usage_count` | How many times used | 25 |\n| `is_active` | Boolean for active status | true |\n| `created_at` | Timestamp | "2024-01-15 10:30:00" |\n\n### Field Requirements Examples\n\n1. **Medical Crisis Template**:\n   ```json\n   {\n     "children_count', True, 'children_ages', True, 'medical_conditions": true\n   }\n   ```\n\n2. **Hunger Template**:\n   ```json\n   {\n     "children_count', True, 'facing_hunger": true\n   }\n   ```\n\n3. **Cold Template**:\n   ```json\n   {\n     "facing_cold', True, 'housing_type": true\n   }\n   ```\n\n## Template Rendering Process\n\n1. Select appropriate template based on family data and post context\n2. Extract required variables from family profile\n3. Replace template variables with actual family data\n4. Validate rendered comment meets Voice Profile requirements\n5. Return final comment text\n\n## Example Rendered Comments\n\n### Family Data:\n```json\n{\n  "children_count', 3, 'children_ages', [1, 4, 7], 'family_members": [\n    {"name": "Mariam', 'age', 1, 'gender": "female', 'role": "child']]]], {'name': 'Ali', 'age': 4, 'gender': 'male', 'role': 'child'}, {'name': 'Fatima', 'age': 7, 'gender': 'female', 'role': 'child'}, ['asthma'], ['NUMBER | 23] grains of rice for [CHILD_COUNT | 3] children. My [CHILD_AGE_1 | 7]-year-old [CHILD_NAME_1 | Fatima] divides them. [CHILD_AGE_2 | 4] each. She keeps [CHILD_AGE_3 | 1] for [CHILD_NAME_3 | Mariam].', "She's too small,", ['CHILD_NAME_1 | Fatima] says. "She needs more to grow.', ["CHILD_NAME_1 | She] doesn't know [CHILD_NAME_3 | Mariam] won't live to grow.\n```"]]]]