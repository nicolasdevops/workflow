<!DOCTYPE html>
<html>
<head>
    <title>Gaza Protocol Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>
    <h1>Gaza 72-Hour Protocol - Live Dashboard</h1>
    
    <div id="stats">
        <div>Total Families: <span id="families">0</span></div>
        <div>Comments Today: <span id="comments">0</span></div>
        <div>Coverage: <span id="coverage">0%</span></div>
    </div>
    
    <div id="families-grid"></div>
    
    <script>
        const supabase = createClient(
            'https://xxxxx.supabase.co',
            'eyJhbGc...'
        )
        
        async function updateDashboard() {
            // Get family stats
            const { data: families } = await supabase
                .from('families')
                .select('*')
            
            // Get today's comments
            const { data: comments } = await supabase
                .from('comments_deployed')
                .select('*')
                .gte('posted_at', new Date().toISOString().split('T')[0])
            
            // Update UI
            document.getElementById('families').innerText = families.length
            document.getElementById('comments').innerText = comments.length
            
            // Calculate coverage
            const targetPosts = 41 * 5 // 41 accounts, ~5 posts each
            const coverage = (comments.length / targetPosts * 100).toFixed(1)
            document.getElementById('coverage').innerText = coverage + '%'
            
            // Show family grid
            const grid = document.getElementById('families-grid')
            grid.innerHTML = families.map(f => `
                <div class="family-card">
                    <h3>${f.name}</h3>
                    <p>Handle: ${f.instagram_handle}</p>
                    <p>Last Post: ${f.last_comment_at || 'Never'}</p>
                    <p>Children: ${f.children_count}</p>
                </div>
            `).join('')
        }
        
        // Update every 30 seconds
        setInterval(updateDashboard, 30000)
        updateDashboard()
    </script>
</body>
</html>
